<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<project default="build"
	name="Create Runnable Jar for Project de.yogularm with Jar-in-Jar Loader">
	
	<target name="check-keys">
	    <available file="yogularmKeys" property="keys.present"/>
	</target>

	
	<target name="jar">
		<jar destfile="../exe/Yogularm.jar">
			<manifest>
				<attribute name="Main-Class"
					value="org.eclipse.jdt.internal.jarinjarloader.JarRsrcLoader" />
				<attribute name="Rsrc-Main-Class" value="de.yogularm.launcher.SwingLauncher" />
				<attribute name="Class-Path" value="." />
				<attribute name="Rsrc-Class-Path"
					value="./ gluegen-rt.jar jogl.all.jar nativewindow.all.jar" />
			</manifest>
			<zipfileset src="jar-in-jar-loader.zip" />
			<fileset dir="../bin" />
		</jar>
	</target>
	
	<target name="sign-error" depends="check-keys" unless="keys.present">
		<echo message="Warning: WebStart will not work because JAR could not be signed" />
		<echo message="Generate the keys using the following jdk tool:" />
		<echo message="keytool -genkey -keystore yogularmKeys -alias yogularmKeys " />
		<echo message="Save the file as yogularmKeys in the dev folder" />
		<echo message="Insert the password in this file in the line property &lt;name=&quot;keypass&quot; value=&quot;-here-&quot; /&gt;" />
	</target>

	
	<target name="sign-ok" depends="check-keys" if="keys.present">
		<!-- Insert your password in the value="" attribute: -->
		<property name="keypass" value="--your-password-here--" />
	
		<signjar alias="yogularmKeys" keystore="yogularmKeys" lazy="true" storepass="${keypass}">
			<fileset dir="../exe/" includes="*.jar" />
		</signjar>
	</target>
	 
	<target name="build" depends="jar" />
	<target name="sign" depends="sign-ok, sign-error" />
</project>
